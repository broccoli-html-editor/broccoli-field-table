!function e(t,r,n){function a(i,o){if(!r[i]){if(!t[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(p)return p(i,!0);throw new Error("Cannot find module '"+i+"'")}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return a(r?r:e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var p="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,r){t.exports=function(e){function t(e){var t={},r=JSON.parse(JSON.stringify(e));switch(t.ext=px.utils.getExtension(r).toLowerCase(),t.ext){case"csv":t.type="text/csv";break;case"doc":t.type="application/msword";break;case"xls":t.type="application/vnd.ms-excel";break;case"ppt":t.type="application/vnd.ms-powerpoint";break;case"docx":t.type="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"xlsx":t.type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;case"pptx":t.type="application/vnd.openxmlformats-officedocument.presentationml.presentation";break;default:t.type="text/csv"}return t}var r=e.resourceMgr;this.bind=function(e,t,r,n){e=e||{};var a="";e.output&&(a+=e.output),"canvas"==t&&(a.length||(a+='<tr><td style="text-align:center;">ダブルクリックして編集してください。</td></tr>')),setTimeout(function(){n(a)},0)},this.mkPreviewHtml=function(e,t,r){e=e||{};var n="";e.output&&(n+=e.output),n=$("<table>"+n+"</table>"),r(n.get(0).outerHTML)},this.normalizeData=function(e,t){var r=e;return typeof e!=typeof{}&&(r={resKey:"",output:"",header_row:0,header_col:0,cell_renderer:"text",renderer:"simplify"}),r},this.mkEditor=function(e,t,n,a){var p=$("<div>");typeof t!=typeof{}&&(t={}),"string"!=typeof t.resKey&&(t.resKey="");var i=(r.getResource(t.resKey),$("<div>"));p.append(i),t.resKey&&i.html("").append($('<button type="button">エクセルで開く</button>').attr({title:r.getResourceOriginalRealpath(t.resKey),"data-excel-realpath":r.getResourceOriginalRealpath(t.resKey)}).click(function(){var e=$(this).attr("data-excel-realpath");px.utils.openURL(e)})),p.append($("<input>").attr({name:e.name,type:"file",webkitfile:"webkitfile"}).css({width:"100%"}).bind("change",function(){var e=$(this).val();e&&i.html("選択しました")})),p.append($("<div>").append($("<span>").text("ヘッダー行:")).append($("<input>").attr({name:e.name+":header_row",type:"number",value:t.header_row}))),p.append($("<div>").append($("<span>").text("ヘッダー列:")).append($("<input>").attr({name:e.name+":header_col",type:"number",value:t.header_col}))),p.append($("<div>").append($("<span>").text("再現方法:")).append($("<label>").append($("<input>").attr({name:e.name+":renderer",type:"radio",value:"simplify"})).append($("<span>").text("単純化"))).append($("<label>").append($("<input>").attr({name:e.name+":renderer",type:"radio",value:"strict"})).append($("<span>").text("そのまま表示")))),p.find('input[name="'+e.name+':renderer"][value="'+t.renderer+'"]').attr({checked:"checked"}),p.append($("<div>").append($("<span>").text("セルの表現方法:")).append($("<label>").append($("<input>").attr({name:e.name+":cell_renderer",type:"radio",value:"html"})).append($("<span>").text("HTML"))).append($("<label>").append($("<input>").attr({name:e.name+":cell_renderer",type:"radio",value:"text"})).append($("<span>").text("テキスト"))).append($("<label>").append($("<input>").attr({name:e.name+":cell_renderer",type:"radio",value:"markdown"})).append($("<span>").text("Markdown")))),p.find('input[name="'+e.name+':cell_renderer"][value="'+t.cell_renderer+'"]').attr({checked:"checked"}),$(n).html(p),setTimeout(function(){a()},0)},this.duplicateData=function(e,t){e=JSON.parse(JSON.stringify(e)),e.resKey=r.duplicateResource(e.resKey),t(e)},this.saveEditorContent=function(e,n,a,p){var i=$(e);typeof n!=typeof{}&&(n={}),"string"!=typeof n.resKey&&(n.resKey=""),r.getResource(n.resKey)===!1&&(n.resKey=r.addResource());var o=i.find("input[name="+a.name+"]").val();if(px.utils.isFile(o)){var l=t(o);r.updateResource(n.resKey,l,function(){})}else n.resKey&&r.resetBase64FromBin(n.resKey);n.header_row=i.find('input[name="'+a.name+':header_row"]').val(),n.header_col=i.find('input[name="'+a.name+':header_col"]').val(),n.cell_renderer=i.find('input[name="'+a.name+':cell_renderer"]:checked').val(),n.renderer=i.find('input[name="'+a.name+':renderer"]:checked').val();var d=r.getResource(n.resKey);d.isPrivateMaterial=!0;var c=r.getResourceOriginalRealpath(n.resKey);px.utils.isFile(c)||(c=d.realpath),px.utils.isFile(c)||(c=o);var s=px.cmd("php");s+=" "+px.path.resolve(_pj.get("path")+"/"+_pj.get("entry_script")),s+=' "/?PX=px2dthelper.convert_table_excel2html',s+="&path="+px.php.urlencode(c),s+="&header_row="+px.php.urlencode(n.header_row),s+="&header_col="+px.php.urlencode(n.header_col),s+="&cell_renderer="+px.php.urlencode(n.cell_renderer),s+="&renderer="+px.php.urlencode(n.renderer),s+='"',n.output=px.execSync(s),n.output=JSON.parse(n.output+""),p(n)}}},{}],2:[function(e,t,r){!function(t){t.BroccoliHtmlEditorTableField=e("../libs/main.js")}(window)},{"../libs/main.js":1}]},{},[2]);